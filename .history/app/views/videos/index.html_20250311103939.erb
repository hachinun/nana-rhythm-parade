<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTuber Karaoke Videos</title>
    <link rel="stylesheet" href="styles.css"> <!-- ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ ã™ã‚‹å ´åˆ -->
  </head>
  <body>
    <div class="container">
      <!-- ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ† -->
      <header>
        <h1>ãªãªãŸã¾æ­Œã£ã¦ï¼ˆä»®é¡Œï¼‰</h1>
      </header>

      <!-- ç¾åœ¨å†ç”Ÿä¸­ã®å‹•ç”» -->
      <div id="current-video">
        <h1><%= @current_video.song_title %> - <%= @current_video.artist %></h1>
        <iframe width="640" height="360" 
          src="https://www.youtube.com/embed/<%= @current_video.video_id %>?start=<%= @current_video.start_seconds %>&end=<%= @current_video.end_seconds %>" 
          frameborder="0" allowfullscreen>
        </iframe>
      </div>

      <!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒœã‚¿ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ãƒœã‚¿ãƒ³ -->
      <div class="toggle-btn-container">
        <button id="toggle-search" class="toggle-btn">æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º</button>
        <button id="toggle-filters" class="toggle-btn">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¡¨ç¤º</button>
      </div>

      <!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
      <div id="search-container" class="search-container" style="display:none;">
        <form action="<%= videos_path %>" method="get" id="search-form">
          <input type="text" name="query" placeholder="æ›²åã‚„ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã‚’æ¤œç´¢" value="<%= params[:query] %>">
          <button type="submit">æ¤œç´¢</button>
        </form>
      </div>

      <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒœã‚¿ãƒ³ -->
      <div id="filter-container" class="filter-container" style="display:none;">
        <div class="filter-buttons">
          <button id="show-all" class="filter-btn">ã™ã¹ã¦è¡¨ç¤º</button>
          <button id="show-favorites" class="filter-btn">ãŠæ°—ã«å…¥ã‚Šã®ã¿è¡¨ç¤º</button>
          <button id="filter-start-0" class="filter-btn">æ­Œã£ã¦ã¿ãŸ</button>
          <button id="filter-start-nonzero" class="filter-btn">ã‚«ãƒ©ã‚ªã‚±</button>
        </div>
      </div>

      <!-- å‹•ç”»ã®ãƒªã‚¹ãƒˆ -->
      <div id="video-list" data-videos="<%= @videos.to_json %>">
        <%= render partial: "video_list", locals: { videos: @videos } %>
      </div>

      <!-- å†ç”Ÿã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
      <div id="player-controls" class="player-controls">
        <button id="shuffle-btn" class="control-btn">ğŸ”€</button>
        <button id="play-btn" class="control-btn">
          <i class="fa-solid fa-play"></i>
        </button>
        <button id="next-btn" class="control-btn">â­ï¸</button>
        <button id="repeat-btn" class="control-btn">ğŸ”</button>
      </div>

    </div>

    <!-- YouTube Player APIã‚’èª­ã¿è¾¼ã‚€ -->
    <script src="https://www.youtube.com/iframe_api"></script>

    <!-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®JavaScript -->
    <%= javascript_include_tag 'application', type: 'module' %>

    <script>
      // æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º/éè¡¨ç¤º
      document.getElementById('toggle-search').addEventListener('click', function() {
        const searchContainer = document.getElementById('search-container');
        if (searchContainer.style.display === 'none') {
          searchContainer.style.display = 'block';
          this.textContent = 'æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’éè¡¨ç¤º';
        } else {
          searchContainer.style.display = 'none';
          this.textContent = 'æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º';
        }
      });

      // ãƒ•ã‚£ãƒ«ã‚¿ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º/éè¡¨ç¤º
      document.getElementById('toggle-filters').addEventListener('click', function() {
        const filterContainer = document.getElementById('filter-container');
        if (filterContainer.style.display === 'none') {
          filterContainer.style.display = 'block';
          this.textContent = 'ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’éè¡¨ç¤º';
        } else {
          filterContainer.style.display = 'none';
          this.textContent = 'ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¡¨ç¤º';
        }
      });
    </script>

  </body>
</html>
